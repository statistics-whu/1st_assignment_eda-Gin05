---
title: "链家二手房的数据探索"
author:
  - 张矜 2023281051017
documentclass: ctexart
keywords:
  - 中文
  - R Markdown
output:
  rticles::ctex:
    fig_caption: yes
    number_sections: yes
    toc: yes
---
```{r setup, include = FALSE,echo = FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	error = FALSE,
	fig.align = "center",
	message = FALSE,
	warning = FALSE,
	out.width = "100%",
	split = FALSE
)
library(showtext)
showtext_auto(enable = TRUE)
#load library
library(tidyverse)
library(kableExtra)
library(lubridate)
library(scales)
library(plotly)
library(patchwork)
library(ggrepel)
```

# 你的主要发现

1. 随房屋面积的上升，房屋总价明显上升。且房屋建筑面积越大时，房屋总价的置信区间明显变宽。其中相同房屋面积的情况下，房本满2年的房屋总价，在建筑面积135以上的区间，整体趋势高于房本未满2年的房型。

2. 在本次数据范围的8类不同房屋主要朝向下，房价与房屋面积关系拟合曲线整体呈现上升趋势，除了朝向东和朝向西的拟合曲线出现了一定程度的下降区间。

3. 探索各房屋建筑形式中装修状况的比例，主流趋势为：装修状况为“精装”的房屋所占比例最大，占比约为50%，装修状况为“简装”的房屋所占比例次之。
    

# 数据介绍

本报告**链家**数据获取方式如下：
    
报告人在2023年9月12日获取了[链家武汉二手房网站](https://wh.lianjia.com/ershoufang/)数据。
    
- 链家二手房网站默认显示100页，每页30套房产，因此本数据包括3000套房产信息；
    
- 数据包括了页面可见部分的文本信息，具体字段及说明见作业说明。

 **说明：**数据仅用于教学；由于不清楚链家数据的展示规则，因此数据可能并不是武汉二手房市场的随机抽样，结论很可能有很大的偏差，甚至可能是错误的。
    
```{r}
# 载入数据和预处理

lj<- read_csv("C:/Users/X1C/Desktop/M/02-统计学_定量分析-数据思维与商业统计/作业/2023-09-12_cleaned.csv")
View(lj)
# EDA ---------------------------------------------------------------------

## 如下语句可以解决画图中的中文显示问题，当然你可以用showtext包来解决

theme_set(theme(text = element_text(family="Songti SC",size = 10))) #这里family设置成你系统中的中文字体名。

# 做一些数据预处理，比如把字符型变成factor。
```

# 数据概览
数据表（lj)共包括`r names(lj)`等`r ncol(lj)`个变量,共`r nrow(lj)`行。表的前10行示例如下：
```{r}
lj %>% 
  head(10) %>%
  kable(caption = "武汉链家二手房") %>% 
  kable_styling()
```


各变量的简短信息：
```{r}
glimpse(lj)
```


各变量的简短统计：
```{r}
summary(lj)
```


可以看到：

- 在3000套二手房数据中，房屋的总价分布在10.6（万）与1380.0（万）之间，平均房价为155.9（万）；

- 在3000套二手房数据中，房屋的建筑面积分布在22.77（平方米）与588.66（平方米）之间，平均建筑面积为100.87（平方米）；

- 在3000套二手房数据中，卧室数量的中位数为三居室，卧室数量的平均值为2.695；起居室数量的中位数为两厅，起居室数量的平均值为1.709 


# 探索性分析

## 变量1的数值描述与图形
```{r}
ggplot(data = lj) +
geom_smooth(mapping = aes(x = building_area, y =price_ttl,color = if_2y))+labs(
    title = "房价与房屋建筑面积、房本是否满两年的关系", x = "房屋建筑面积",y ="房屋总价")
```

发现：

- 发现1：随房屋面积的上升，房屋总价明显上升，且房屋建筑面积越大时，房屋总价的置信区间明显变宽。

- 发现2：其中相同房屋面积的情况下，房本满2年的房屋总价，明显高于房本未满2年的房型。

## 变量2的数值描述与图形
```{r}
ggplot(data = lj) +
geom_smooth(
  mapping = aes(x =building_area , y =price_ttl))+
facet_wrap(~ directions1, nrow = 2)+labs(
    title = "在各类不同房屋主要朝向下，房价与房屋建筑面积关系", x = "房屋建筑面积",y ="房屋总价")
```

发现：

- 发现1：房屋主要朝向为南的房子最多，且建筑面积200以上的房屋，主要朝向只有南、西南或东南.建筑面积300以上的房屋，主要朝向只有南。

- 发现2：相同房屋建筑面积下，所有方向中，房屋主要朝向的为南房屋总价最高。

## 变量3的数值描述与图形
```{r}
ggplot(data = lj) +
geom_bar(
mapping = aes(x = property_style, fill = decoration),
position = "fill"
)+labs(
    title = "各房屋建筑形式中装修状况的比例", x = "房屋建筑形式",y = "所占比例")
```

发现：

- 发现1：在建筑形式为板楼、板塔结合、塔楼的房屋中，装修状况为“精装”的房屋所占比例最大，装修状况为“简装”的房屋所占比例次之；在建筑形式为平房还有缺失建筑形式数据的房屋中，装修状况为“简装”的房屋所占比例最大，装修状况为“精装”的房屋所占比例次之。

- 发现2：在建筑形式为平房的房屋中，装修状况不存在毛坯或其他的情况。


## 探索问题1：在房屋建筑面积144以内（普通住宅），房本满2年的房屋总价和房本未满2年的价格差异分析
```{r}
lj_144<- filter(lj,building_area <= 144) 
ggplot(data = lj_144) +
geom_smooth(mapping = aes(x = building_area, y =price_ttl,color = if_2y))+labs(
    title = "普通住宅房价与房屋建筑面积、房本是否满两年的关系", x = "房屋建筑面积",y ="房屋总价")
```

发现：

- 发现1：在房屋建筑面积130以内，房本满两年和房本未满两年的房屋总价几乎没有差异，甚至房屋建筑面积100~130之间，房本满两年的房屋总价出现高于房本未满两年的房屋总价的异常现象，可能由于数据量不足导致。

- 发现2：在房屋建筑面积130以上，在相同的房屋建筑面积下，房本满两年的房屋总价明显高于未满两年的，且趋势稳定。

## 探索问题2：在各类不同房屋主要朝向下，房屋总价与房屋面积关系拟合曲线出现了一定程度的下降区间,以朝西为例进行分析
```{r}
lj_west<- filter(lj,directions1 == "西") 
ggplot(data = lj_west) +
geom_smooth(
  mapping = aes(x =building_area , y =price_ttl))+labs(
    title = "在房屋主要朝向为西时，房价与房屋建筑面积关系", x = "房屋建筑面积",y ="房屋总价")
View(lj_west)
```
    
发现：

- 发现1:筛选在房屋主要朝向为西时，房价与房屋建筑面积关系出现先上升后下降的趋势。查看房屋主要朝向为西的数据发现，3000套二手房中主要朝向为西的房屋仅有19套，在共计八个朝向中，该数据严重不足，房屋总价与房屋面积关系出现了一定程度的下降区间，可能是由于数据量不足导致拟合不够精确。

- 发现2：建筑面积在90~135的区间内，房屋总价的置信区间异常宽大，从一定程度印证了数据量不足的上述发现。

## 探索问题3：在3000套二手房房屋中，平房的装修状况与其他建筑形式的房屋明显有差异，仅存在简装和精装两种情况，且其比例也和其他建筑形式的房屋有差异。
```{r}
lj_平房<- filter(lj,property_style == "平房") 
summary(lj_平房)
```

发现：

- 发现1：在3000套二手房房屋中，平房仅有5套，导致平房的装修状况与其他建筑形式的房屋明显有差异。

- 发现2：从平房的数据量来看，可能是数据本身有偏，收集不全面；另一方面，由于该数据集缺失房屋年代数据，从建筑年代上推测，2000年后的房屋建筑形式为平房的数量较少，且平房自住的比例较高，所以在二手房交易市场的平房数据结论不具有普遍性。

---

# 发现总结

用1-3段话总结你的发现。

- 随房屋面积的上升，房屋总价呈现明显上升趋势；且房屋建筑面积越大时，房屋总价的置信区间明显变宽，即波动变大。在房屋建筑面积130以上，在相同的房屋建筑面积下，房本满两年的房屋总价明显高于未满两年的，且趋势稳定。
    
- 在房屋主要朝向为南的房子最多，且建筑面积200以上的豪宅（注：面积大于144平方米为非普通住宅，又名豪宅），主要朝向只有南、西南或东南.建筑面积300以上的房屋，主要朝向只有南。筛选在房屋主要朝向为西时，房价与房屋建筑面积关系出现先上升后下降的趋势。查看房屋主要朝向为西的数据发现，3000套二手房中主要朝向为西的房屋仅有19套，在共计八个朝向中，该数据严重不足，房屋总价与房屋面积关系出现了一定程度的下降区间，可能是由于数据量不足导致拟合不够精确。
    
- 在建筑形式为板楼、板塔结合、塔楼的房屋中，装修状况为“精装”的房屋所占比例最大，装修状况为“简装”的房屋所占比例次之；在建筑形式为平房还有缺失建筑形式数据的房屋中，装修状况为“简装”的房屋所占比例最大，装修状况为“精装”的房屋所占比例次之。在3000套二手房房屋中，平房仅有5套，从平房的数据量来看，可能是数据本身有偏，收集不全面；另一方面，由于该数据集缺失房屋年代数据，从建筑年代上推测，2000年后的房屋建筑形式为平房的数量较少，且平房自住的比例较高，所以在二手房交易市场的平房数据不具有普遍性。
